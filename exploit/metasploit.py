
import json
import pty
import re
import socket
import subprocess
import time
from typing import List, Dict

from pymetasploit3.msfrpc import MsfRpcClient

from config import MSF_INDEX_FILE
from utils.logger import Logger
from constants import ExploitManagerConstants


class ExploitManager:
    """
    Class for testing and executing exploits using Metasploit Framework.
    """

    def __init__(self, host='127.0.0.1', password='msf', port=55552):
        self.logger = Logger(__name__).get_logger()
        self.client = self._start_msf(host, password, port)
        with open(MSF_INDEX_FILE, 'r') as f:
            self.msf_index = json.load(f)