
import json

from advising.llm import Advisor
from config import REPORT_DIR
from exploit.metasploit import ExploitManager
from recon.async_scanner import NetworkScanner
from utils.logger import Logger
from constants import PenetrationTesterConstants


class PenetrationTester:
    """
    A class representing a Penetration Tester which combines the functionality of a NetworkScanner and an ExploitManager.

    Attributes:
    target_subnets (list): A list of subnets to be scanned.
    scanner (NetworkScanner): An instance of NetworkScanner to perform network scans on the target subnets.
    exploit_manager (ExploitManager): An instance of ExploitManager to find and manage exploits for discovered services.
    """
    def __init__(self, target_subnets, top_ports):